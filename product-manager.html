<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“æ•°æ®ç®¡ç†å·¥å…· (å…¨è¯­ç§ç‰ˆ) - MEWPOW</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 2rem;
            padding: 3rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #64748b;
            margin-bottom: 3rem;
            font-size: 1.125rem;
        }

        .section {
            margin-bottom: 3rem;
        }

        .section h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #0f172a;
        }

        .upload-area {
            border: 3px dashed #e2e8f0;
            border-radius: 1rem;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: #f8fafc;
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: #ede9fe;
        }

        input[type="file"] {
            display: none;
        }

        .btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #64748b;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .preview {
            background: #f8fafc;
            border-radius: 1rem;
            padding: 2rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .preview pre {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #0f172a;
        }

        .instructions {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }

        .instructions h3 {
            color: #92400e;
            margin-bottom: 0.5rem;
        }

        .instructions ul {
            margin-left: 1.5rem;
            color: #78350f;
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .success {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 1rem;
            border-radius: 0.5rem;
            color: #065f46;
            margin-top: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            display: block;
            overflow-x: auto;
            white-space: nowrap;
        }

        th,
        td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: #f8fafc;
            font-weight: 600;
            color: #475569;
        }

        .category-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ“Š äº§å“æ•°æ®ç®¡ç†å·¥å…· (å…¨è¯­ç§ç‰ˆ)</h1>
        <p class="subtitle">æ”¯æŒï¼šä¸­(ç®€/ç¹)ã€è‹±ã€æ—¥ã€éŸ©ã€å¾·ã€æ³•ã€è¥¿</p>

        <div class="instructions">
            <h3>ğŸ“ ä½¿ç”¨è¯´æ˜</h3>
            <ul>
                <li><strong>ç¬¬1æ­¥</strong>: ç‚¹å‡»ä¸‹æ–¹ç°è‰²æŒ‰é’®â€œä¸‹è½½Excelæ¨¡æ¿â€ï¼Œè·å–æœ€æ–°çš„å…¨è¯­ç§è¡¨æ ¼ã€‚</li>
                <li><strong>ç¬¬2æ­¥</strong>: åœ¨Excelä¸­å¡«å†™äº§å“ä¿¡æ¯ã€‚æ³¨æ„ï¼š
                    <ul>
                        <li><strong>ID</strong>: å¿…é¡»å”¯ä¸€ï¼Œå»ºè®®ç”¨è‹±æ–‡ï¼ˆå¦‚ humidifier-01ï¼‰ã€‚</li>
                        <li><strong>ç±»åˆ«</strong>: åªèƒ½å¡«ä»¥ä¸‹å•è¯ï¼šhumidifier, hairdryer, heater, fan, purifier, toothbrush,
                            shoedryer, mosquito, trimmerã€‚</li>
                        <li><strong>å›¾ç‰‡è·¯å¾„</strong>: å¡«å†™å¦‚ /products/humidifier/x1.jpgï¼Œç¡®ä¿å›¾ç‰‡æ–‡ä»¶çœŸçš„æ”¾åœ¨é‚£ä¸ªæ–‡ä»¶å¤¹é‡Œã€‚</li>
                    </ul>
                </li>
                <li><strong>ç¬¬3æ­¥</strong>: å°†å¡«å¥½çš„Excelæ–‡ä»¶æ‹–æ‹½åˆ°ä¸‹æ–¹è™šçº¿æ¡†å†…ã€‚</li>
                <li><strong>ç¬¬4æ­¥</strong>: ç‚¹å‡»â€œä¸‹è½½ products.jsonâ€ï¼Œå°†ä¸‹è½½çš„æ–‡ä»¶æ”¹åä¸º <code>products.json</code>ï¼Œè¦†ç›–ç½‘ç«™æ–‡ä»¶å¤¹é‡Œçš„åŒåæ–‡ä»¶ã€‚</li>
            </ul>
        </div>

        <div class="section">
            <h2>1. ä¸Šä¼ å¡«å¥½çš„Excelæ–‡ä»¶</h2>
            <div class="upload-area" id="uploadArea">
                <p style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“</p>
                <p style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">ç‚¹å‡»é€‰æ‹©æ–‡ä»¶ æˆ– æ‹–æ‹½åˆ°æ­¤å¤„</p>
                <p style="color: #64748b;">æ”¯æŒ .xlsx å’Œ .xls æ ¼å¼</p>
                <input type="file" id="fileInput" accept=".xlsx,.xls">
            </div>
            <div style="text-align: center; margin-top: 1rem;">
                <button class="btn btn-secondary" id="downloadTemplate">â¬‡ï¸ ä¸‹è½½Excelæ¨¡æ¿ (å«8ç§è¯­è¨€)</button>
            </div>
        </div>

        <div class="section" id="previewSection" style="display: none;">
            <h2>2. æ•°æ®é¢„è§ˆ & ä¸‹è½½</h2>
            <div class="success">
                âœ… è½¬æ¢æˆåŠŸï¼å…±è¯†åˆ«åˆ° <span id="productCount">0</span> ä¸ªäº§å“ã€‚è¯·æ£€æŸ¥ä¸‹æ–¹è¡¨æ ¼æ˜¯å¦æ­£ç¡®ã€‚
            </div>
            <div id="tablePreview"></div>

            <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-primary" id="downloadBtn" style="font-size: 1.2rem; padding: 1.2rem 3rem;">â¬‡ï¸ ä¸‹è½½
                    products.json</button>
                <button class="btn btn-secondary" id="resetBtn">é‡æ–°ä¸Šä¼ </button>
            </div>

            <details style="margin-top: 2rem; color: #64748b; cursor: pointer;">
                <summary>æŸ¥çœ‹åŸå§‹JSONæ•°æ® (ä»…ä¾›æŠ€æœ¯äººå‘˜è°ƒè¯•)</summary>
                <div class="preview" id="jsonPreview" style="margin-top: 1rem;"></div>
            </details>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        let jsonData = [];

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewSection = document.getElementById('previewSection');
        const jsonPreview = document.getElementById('jsonPreview');
        const tablePreview = document.getElementById('tablePreview');
        const productCount = document.getElementById('productCount');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const downloadTemplate = document.getElementById('downloadTemplate');

        // Upload area click
        uploadArea.addEventListener('click', () => fileInput.click());

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) processFile(file);
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) processFile(file);
        });

        // Process Excel file
        function processFile(file) {
            const reader = new FileReader();

            reader.onload = (e) => {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const rows = XLSX.utils.sheet_to_json(firstSheet);

                jsonData = rows.map(row => {
                    // Helper to split specs string into array
                    const splitSpecs = (str) => str ? str.split('\n').map(s => s.trim()).filter(Boolean) : [];

                    return {
                        id: row['ID'] || '',
                        model: row['å‹å·'] || '',
                        category: row['ç±»åˆ«(Category)'] || '',
                        image: row['å›¾ç‰‡è·¯å¾„(Image)'] || '',
                        moq: parseInt(row['èµ·è®¢é‡(MOQ)'] || 1000),
                        oem: true,
                        // Multi-language Names
                        names: {
                            en: row['åç§°(è‹±æ–‡)'] || row['åç§°(è‹±æ–‡)'] || '',
                            zh: row['åç§°(ç®€ä½“)'] || '',
                            'zh-TW': row['åç§°(ç¹ä½“)'] || '',
                            ja: row['åç§°(æ—¥æ–‡)'] || '',
                            ko: row['åç§°(éŸ©æ–‡)'] || '',
                            de: row['åç§°(å¾·æ–‡)'] || '',
                            fr: row['åç§°(æ³•æ–‡)'] || '',
                            es: row['åç§°(è¥¿æ–‡)'] || ''
                        },
                        // Multi-language Specs (expecting newline separated strings in Excel)
                        specs: {
                            en: splitSpecs(row['è§„æ ¼(è‹±æ–‡)']),
                            zh: splitSpecs(row['è§„æ ¼(ç®€ä½“)']),
                            'zh-TW': splitSpecs(row['è§„æ ¼(ç¹ä½“)']),
                            ja: splitSpecs(row['è§„æ ¼(æ—¥æ–‡)']),
                            ko: splitSpecs(row['è§„æ ¼(éŸ©æ–‡)']),
                            de: splitSpecs(row['è§„æ ¼(å¾·æ–‡)']),
                            fr: splitSpecs(row['è§„æ ¼(æ³•æ–‡)']),
                            es: splitSpecs(row['è§„æ ¼(è¥¿æ–‡)'])
                        },
                        // Certifications
                        certifications: {
                            ce: !!row['è®¤è¯-CE'],
                            fcc: !!row['è®¤è¯-FCC'],
                            rohs: !!row['è®¤è¯-RoHS'],
                            iso9001: !!row['è®¤è¯-ISO9001']
                        }
                    };
                });

                displayPreview();
            };

            reader.readAsArrayBuffer(file);
        }

        // Display preview
        function displayPreview() {
            previewSection.style.display = 'block';
            productCount.textContent = jsonData.length;

            // Table preview
            tablePreview.innerHTML = `
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>ç®€ä½“åç§°</th>
              <th>è‹±æ–‡åç§°</th>
              <th>ç±»åˆ«</th>
              <th>èµ·è®¢é‡</th>
              <th>è®¤è¯</th>
            </tr>
          </thead>
          <tbody>
            ${jsonData.map(p => `
              <tr>
                <td>${p.id}</td>
                <td>${p.names.zh}</td>
                <td>${p.names.en}</td>
                <td><span class="category-badge">${p.category}</span></td>
                <td>${p.moq}</td>
                <td>
                    ${p.certifications.ce ? 'CE ' : ''}
                    ${p.certifications.fcc ? 'FCC ' : ''}
                </td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;

            // JSON preview
            jsonPreview.innerHTML = `<pre>${JSON.stringify(jsonData, null, 2)}</pre>`;

            previewSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Download JSON
        downloadBtn.addEventListener('click', () => {
            const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'products.json';
            a.click();
            URL.revokeObjectURL(url);
        });

        // Reset
        resetBtn.addEventListener('click', () => {
            previewSection.style.display = 'none';
            fileInput.value = '';
            jsonData = [];
        });

        // Download template
        downloadTemplate.addEventListener('click', () => {
            const template = [
                {
                    'ID': 'humidifier-x1',
                    'å‹å·': 'X1',
                    'ç±»åˆ«(Category)': 'humidifier',
                    'å›¾ç‰‡è·¯å¾„(Image)': '/products/humidifier/X1.jpg',
                    'èµ·è®¢é‡(MOQ)': 1000,
                    'åç§°(ç®€ä½“)': 'å–µåŠ¨åŠ›åŠ æ¹¿å™¨ X1',
                    'åç§°(ç¹ä½“)': 'å–µå‹•åŠ›åŠ æ¿•å™¨ X1',
                    'åç§°(è‹±æ–‡)': 'MEWPOW Humidifier X1',
                    'åç§°(æ—¥æ–‡)': 'MEWPOWåŠ æ¹¿å™¨ X1',
                    'åç§°(éŸ©æ–‡)': 'MEWPOW ê°€ìŠµê¸° X1',
                    'åç§°(å¾·æ–‡)': 'MEWPOW Luftbefeuchter X1',
                    'åç§°(æ³•æ–‡)': 'Humidificateur MEWPOW X1',
                    'åç§°(è¥¿æ–‡)': 'Humidificador MEWPOW X1',
                    'è§„æ ¼(ç®€ä½“)': 'é¢œè‰²: ç™½è‰²\n4000æ¯«å®‰ç”µæ± \nABSæè´¨',
                    'è§„æ ¼(ç¹ä½“)': 'é¡è‰²: ç™½è‰²\n4000æ¯«å®‰é›»æ± \nABSæè³ª',
                    'è§„æ ¼(è‹±æ–‡)': 'Color: White\n4000mAh Battery\nABS Material',
                    'è§„æ ¼(æ—¥æ–‡)': 'ã‚«ãƒ©ãƒ¼: ãƒ›ãƒ¯ã‚¤ãƒˆ\n4000mAhãƒãƒƒãƒ†ãƒªãƒ¼\nABSç´ æ',
                    'è§„æ ¼(éŸ©æ–‡)': 'ìƒ‰ìƒ: í™”ì´íŠ¸\n4000mAh ë°°í„°ë¦¬\nABS ì†Œì¬',
                    'è§„æ ¼(å¾·æ–‡)': 'Farbe: WeiÃŸ\n4000mAh Akku\nABS-Material',
                    'è§„æ ¼(æ³•æ–‡)': 'Couleur: Blanc\nBatterie 4000mAh\nMatÃ©riau ABS',
                    'è§„æ ¼(è¥¿æ–‡)': 'Color: Blanco\nBaterÃ­a 4000mAh\nMaterial ABS',
                    'è®¤è¯-CE': 'TRUE',
                    'è®¤è¯-FCC': 'TRUE',
                    'è®¤è¯-RoHS': 'TRUE',
                    'è®¤è¯-ISO9001': 'TRUE'
                }
            ];

            const ws = XLSX.utils.json_to_sheet(template);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Products');
            XLSX.writeFile(wb, 'product_template_v3.xlsx');
        });
    </script>
</body>

</html>